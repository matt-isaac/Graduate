"0","#undo differencing"
"0","bar_forc_back=diffinv(bar_fit_pred[2:118], differences=1, xi=log(bar[1]))"
"0","bar_forc_lead=diffinv(pred_value, differences=1, xi=log(bar[118]))"
"0","pe <- log(bar[117])"
"0","moe <- 1.96*sqrt(bar.mod$sigma2[1])"
"0","upper_start <- pe + moe"
"0","lower_start <- pe - moe"
"0","bar_forc_upper=diffinv(pred_upper, differences=1, xi = upper_start)"
"0","bar_forc_lower=diffinv(pred_lower, differences=1, xi = lower_start)"
"0","bar_forc_back=ts(bar_forc_back,start=1966,frequency=12)"
"0","bar_forc_lead=ts(bar_forc_lead,start=(1975+(10/12)),frequency=12)"
"0","bar_forc_upper=ts(bar_forc_upper,start=(1975+(10/12)),frequency=12)"
"0","bar_forc_lower=ts(bar_forc_lower,start=(1975+(10/12)),frequency=12)"
"0","df.forc.back <- data.frame(ts = bar_forc_back, time = seq((1966 + 1/12), (1975 + (10/12)), by = (1/12)))"
"0","df.forc.lead <- data.frame(ts = bar_forc_lead, time = seq((1975 + 10/12), (1976 + (10/12)), by = (1/12)))"
"0","df.forc.upper <- data.frame(ts = bar_forc_upper, time = seq((1975 + 10/12), (1976 + (10/12)), by = (1/12)))"
"0","df.forc.lower <- data.frame(ts = bar_forc_lower, time = seq((1975 + 10/12), (1976 + (10/12)), by = (1/12)))"
"0","df.bar <- data.frame(ts = log(bar), time = seq((1966 + 1/12), (1975 + (10/12)), by = (1/12)))"
"0","par(mfrow = c(2,1))"
"0","# Predictions on log scale"
"0","plot.ls <- ggplot() + "
"0","  geom_line(data = df.bar, aes(x = time, y = ts), color = ""navyblue"", size = 1) +"
"0","  geom_line(data = df.forc.back, aes(x = time, y = ts), color = ""red"", size = 1) +"
"0","  geom_line(data = df.forc.lead, aes(x = time, y = ts), color = ""red"", size = 1) +"
"0","  geom_line(data = df.forc.upper, aes(x = time, y = ts), color = ""blue"", size = 1) +"
"0","  geom_line(data = df.forc.lower, aes(x = time, y = ts), color = ""blue"", size = 1) +"
"0","  xlab('Time') +"
"0","  ylab('log(Monthly Armed Robberies)') +"
"0","  scale_y_continuous(limits = c(0, 11), breaks = seq(0, 12, by = 2)) +"
"0","  scale_x_continuous(limits = c(1966, 1977), breaks = seq(1966, 1977, by = 1))"
"0","# plot.ls"
"0","# Predictions on original scale"
"0","bar_forc_back <- exp(bar_forc_back)"
"0","bar_forc_lead <- exp(bar_forc_lead)"
"0","df.forc.lead <- data.frame(ts = bar_forc_lead, time = seq((1975 + 10/12), (1976 + (10/12)), by = (1/12)))"
"0","df.bar <- data.frame(ts = bar, time = seq((1966 + 1/12), (1975 + (10/12)), by = (1/12)))"
"0","plot.os <- ggplot() + "
"0","  geom_line(data = df.bar, aes(x = time, y = ts), color = ""navyblue"", size = 1) +"
"0","  geom_line(data = df.forc.back, aes(x = time, y = ts), color = ""red"", size = 1) +"
"0","  geom_line(data = df.forc.lead, aes(x = time, y = ts), color = ""red"", size = 1) +"
"0","# plot.os"
"0","grid.arrange(plot.ls, plot.os, nrow = 2)"
